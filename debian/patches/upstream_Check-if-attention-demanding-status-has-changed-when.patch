From 89161c40e064958aa192b2202670316671d7e377 Mon Sep 17 00:00:00 2001
From: "Martin T. H. Sandsmark" <martin.sandsmark@kde.org>
Date: Tue, 7 Aug 2012 13:23:28 +0200
Subject: [PATCH] Check if attention demanding status has changed when we
 activate a window.

BUG: 303208
---
 libs/taskmanager/task.cpp |   11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/libs/taskmanager/task.cpp b/libs/taskmanager/task.cpp
index be5f772..1cb72bd 100644
--- a/libs/taskmanager/task.cpp
+++ b/libs/taskmanager/task.cpp
@@ -168,7 +168,16 @@ void Task::refreshIcon()
 void Task::setActive(bool a)
 {
     d->active = a;
-    emit changed(StateChanged);
+
+    TaskChanges changes = StateChanged;
+
+    if (demandsAttention() != d->demandedAttention) {
+        d->demandedAttention = !d->demandedAttention;
+        changes |= AttentionChanged;
+    }
+
+    emit changed(changes);
+
     if (a) {
         emit activated();
     } else {
-- 
1.7.10.4

